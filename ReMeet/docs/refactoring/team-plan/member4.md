# メンバー4: フォームコンポーネント統合・UI最適化担当

## 担当概要
フォーム関連コンポーネントの統合と汎用化、登録・編集画面の統合、UIコンポーネントの最適化を担当。既存の全機能（TagInputWithSuggestions、DateTimePicker、フォームバリデーション）を完全に維持しながら、再利用性を向上させる。

## 全体タスク期間: 6日間

---

## タスク1: 既存フォーム機能の詳細調査（1日目）

### 1.1 TagInput系コンポーネントの詳細分析
**所要時間**: 2時間
**重要度**: 高

- [ ] `TagInputWithSuggestions.tsx` の全機能を詳細に分析
- [ ] **重要**: 新規タグ作成、選択、削除の全フローを調査
- [ ] **重要**: 既存タグ選択 + 新規タグ作成フローを詳細に調査
- [ ] `TagInput`, `TagSelector` の機能との関係を分析
- [ ] 状態管理とイベントハンドリングを調査

### 1.2 DateTimePicker機能の詳細分析
**所要時間**: 1.5時間
**重要度**: 高

- [ ] `EventForm.tsx` の DateTimePicker 実装を詳細に分析
- [ ] **重要**: テーマ対応（ダーク/ライトモード）を調査
- [ ] **重要**: 過去の日付のみ選択可能な制限 (maximumDate) を調査
- [ ] **重要**: 日付クリア機能を調査
- [ ] プラットフォーム固有の動作を調査

### 1.3 フォームバリデーションの詳細分析
**所要時間**: 2時間
**重要度**: 高

- [ ] `PersonForm.tsx` と `EventForm.tsx` のバリデーション詳細を調査
- [ ] **重要**: Zodスキーマの全ルールを詳細に記録
- [ ] React Hook Form との連携パターンを分析
- [ ] エラー表示とユーザビリティを調査
- [ ] 各フィールドの制限事項を記録

### 1.4 登録・編集画面の機能分析
**所要時間**: 1.5時間
**重要度**: 高

- [ ] `person-register.tsx` と `person-edit.tsx` の違いを詳細に分析
- [ ] **重要**: 編集時のデータ取得・更新・バリデーションを調査
- [ ] 画面遷移パターンとパラメータ受け渡しを分析
- [ ] エラーハンドリングと成功時の動作を調査

### 1.5 統合設計の策定
**所要時間**: 1時間
**重要度**: 高

- [ ] 既存機能を完全に維持する統合設計を作成
- [ ] 再利用性を高める汎用化方針を策定
- [ ] 段階的な移行計画を詳細化
- [ ] 他メンバーとの連携ポイントを確認

---

## タスク2: molecules レベルコンポーネントの作成（2日目）

### 2.1 molecules ディレクトリの準備
**所要時間**: 0.5時間
**重要度**: 中

- [ ] `components/molecules/` ディレクトリを作成（メンバー1と連携）
- [ ] TypeScript設定を確認
- [ ] 既存のmolecules構造を調査
- [ ] 命名規則を確認

### 2.2 TagInputField.tsx の作成
**所要時間**: 2.5時間
**重要度**: 高

- [ ] `components/molecules/TagInputField.tsx` を新規作成
- [ ] **重要**: TagInputWithSuggestions の全機能を統合
- [ ] **重要**: 新規タグ入力、サジェスト、既存タグ選択をすべて担保
- [ ] **重要**: value は `string[]` で扱い、既存と同じインターフェース
- [ ] props設計を既存コンポーネントと互換性を保つ

### 2.3 TagInputField のテーマ対応
**所要時間**: 1時間
**重要度**: 高

- [ ] ダーク/ライトモードのテーマ対応を実装
- [ ] 既存のスタイリングを完全に維持
- [ ] テーマ切り替え時の動作を確認
- [ ] アクセシビリティを考慮

### 2.4 DateField.tsx の作成
**所要時間**: 2時間
**重要度**: 高

- [ ] `components/molecules/DateField.tsx` を新規作成
- [ ] **重要**: DateTimePicker のテーマ対応を維持
- [ ] **重要**: 過去の日付のみ選択可能な制限を維持
- [ ] **重要**: 日付クリア機能を維持
- [ ] props設計を汎用的にしつつ、既存機能を完全に維持

### 2.5 molecules コンポーネントの統合テスト
**所要時間**: 2時間
**重要度**: 高

- [ ] TagInputField の全機能テスト
- [ ] DateField の全機能テスト
- [ ] テーマ切り替えテスト
- [ ] 既存コンポーネントとの動作比較
- [ ] 問題があれば即座に修正

---

## タスク3: organisms レベルコンポーネントの作成（3日目）

### 3.1 organisms ディレクトリの準備
**所要時間**: 0.5時間
**重要度**: 中

- [ ] `components/organisms/` ディレクトリを作成（メンバー1と連携）
- [ ] TypeScript設定を確認
- [ ] 既存のorganisms構造を調査
- [ ] 命名規則を確認

### 3.2 PersonForm.tsx の組織化
**所要時間**: 2時間
**重要度**: 高

- [ ] `components/organisms/PersonForm.tsx` を作成
- [ ] **重要**: 既存の PersonForm.tsx からビジネスロジックを完全に分離
- [ ] **重要**: 全バリデーションルール（Zodスキーマ）を維持
- [ ] 新しい TagInputField, DateField を使用
- [ ] プレゼンテーショナルコンポーネントに特化

### 3.3 EventForm.tsx の組織化
**所要時間**: 1.5時間
**重要度**: 高

- [ ] `components/organisms/EventForm.tsx` を作成
- [ ] **重要**: 既存の EventForm.tsx からビジネスロジックを完全に分離
- [ ] 新しい DateField を使用
- [ ] プレゼンテーショナルコンポーネントに特化
- [ ] 既存の全機能を維持

### 3.4 PersonRegistrationForm の統合
**所要時間**: 2時間
**重要度**: 高

- [ ] `PersonRegistrationForm.tsx` を削除し、`PersonForm.tsx` に統合
- [ ] **重要**: 既存の登録機能を完全に維持
- [ ] 統合後の動作を既存と比較確認
- [ ] データの流れに問題がないことを確認

### 3.5 organisms コンポーネントの統合テスト
**所要時間**: 2時間
**重要度**: 高

- [ ] PersonForm の全機能テスト
- [ ] EventForm の全機能テスト
- [ ] フォームバリデーションの詳細テスト
- [ ] 既存フォームとの動作比較
- [ ] 問題があれば即座に修正

---

## タスク4: 登録・編集画面の統合（4日目）

### 4.1 person-register.tsx の拡張設計
**所要時間**: 1時間
**重要度**: 高

- [ ] `id` パラメータの有無による切り替え設計を詳細化
- [ ] 編集モードと新規登録モードの判定ロジックを設計
- [ ] データ取得、更新、作成のフローを設計
- [ ] エラーハンドリングの統一を設計

### 4.2 person-register.tsx の機能拡張
**所要時間**: 2時間
**重要度**: 高

- [ ] `app/person-register.tsx` を編集機能も含むように拡張
- [ ] **重要**: 既存の登録機能を完全に維持
- [ ] **重要**: person-edit.tsx の編集機能を完全に移植
- [ ] `id` パラメータによる動作切り替えを実装

### 4.3 person-edit.tsx の段階的廃止
**所要時間**: 1時間
**重要度**: 中

- [ ] `app/person-edit.tsx` の機能が完全に移植されていることを確認
- [ ] 既存の編集画面への遷移を新しいperson-register.tsxに変更
- [ ] すべての編集機能が正常に動作することを確認
- [ ] person-edit.tsx を削除

### 4.4 event-register.tsx の同様対応
**所要時間**: 1.5時間
**重要度**: 中

- [ ] `app/event-register.tsx` も同様の構造に統一
- [ ] 将来的な編集機能を見越した設計に変更
- [ ] `id` パラメータによる切り替え準備を実装
- [ ] 既存の登録機能を完全に維持

### 4.5 統合画面の最終テスト
**所要時間**: 2.5時間
**重要度**: 高

- [ ] 新しい person-register.tsx での登録機能テスト
- [ ] 新しい person-register.tsx での編集機能テスト
- [ ] 画面遷移の詳細テスト
- [ ] データの整合性確認
- [ ] エラーケースのテスト

---

## タスク5: SwipeableCard の汎用化（5日目）

### 5.1 既存スワイプ機能の詳細調査
**所要時間**: 1.5時間
**重要度**: 高

- [ ] `SwipeablePersonCard.tsx` の全機能を詳細に分析
- [ ] **重要**: スワイプ削除機能と openedMenuIdAtom の連携を調査
- [ ] **重要**: 同時開放制御の仕組みを詳細に調査
- [ ] Jotai との依存関係を分析
- [ ] ジェスチャーハンドリングの詳細を調査

### 5.2 汎用 SwipeableCard の設計
**所要時間**: 1時間
**重要度**: 高

- [ ] `person` prop を汎用的な `item` prop に変更する設計
- [ ] Jotai への依存を疎結合にする設計
- [ ] **重要**: スワイプメニューの同時開放制御を維持する設計
- [ ] 再利用性を高めつつ既存機能を完全に維持する設計

### 5.3 汎用 SwipeableCard の実装
**所要時間**: 2.5時間
**重要度**: 高

- [ ] `components/organisms/SwipeableCard.tsx` を新規作成
- [ ] **重要**: openedMenuIdAtom との連携を完全に維持
- [ ] **重要**: スワイプ削除機能を完全に維持
- [ ] 汎用的な item prop を実装
- [ ] 既存の SwipeablePersonCard と同じ動作を保証

### 5.4 SwipeableCardList の作成
**所要時間**: 1.5時間
**重要度**: 中

- [ ] `components/organisms/SwipeableCardList.tsx` を新規作成
- [ ] リスト管理機能を汎用化
- [ ] パフォーマンスの最適化
- [ ] 既存のリスト表示と同じ動作を保証

### 5.5 SwipeablePersonCard の置き換え
**所要時間**: 1.5時間
**重要度**: 高

- [ ] 既存コードで SwipeablePersonCard を使用している箇所を特定
- [ ] 新しい SwipeableCard に置き換え
- [ ] **重要**: スワイプ機能が完全に同じ動作をすることを確認
- [ ] SwipeablePersonCard.tsx を削除

---

## タスク6: スタイル分離と最終統合（6日目）

### 6.1 スタイルファイルの作成
**所要時間**: 1.5時間
**重要度**: 小

- [ ] `app/(tabs)/people.styles.ts` を作成
- [ ] `app/person-detail.styles.ts` を作成
- [ ] `app/(tabs)/events.styles.ts` を作成
- [ ] 既存の StyleSheet 定義を各ファイルに分離

### 6.2 TabBarBackground の整理
**所要時間**: 1時間
**重要度**: 小

- [ ] `components/molecules/TabBarBackground/` ディレクトリを作成
- [ ] `index.tsx`, `index.ios.tsx` として配置
- [ ] プラットフォーム別の実装を整理
- [ ] 既存機能を完全に維持

### 6.3 全体統合テスト
**所要時間**: 2時間
**重要度**: 高

- [ ] 全フォームコンポーネントの統合テスト
- [ ] 全スワイプ機能の統合テスト
- [ ] 登録・編集画面の統合テスト
- [ ] アプリ全体の動作確認

### 6.4 パフォーマンス最適化
**所要時間**: 1時間
**重要度**: 中

- [ ] コンポーネントの re-render 最適化
- [ ] メモリ使用量の最適化
- [ ] アニメーションのパフォーマンス確認
- [ ] 必要に応じて改善を実施

### 6.5 完了報告と引き継ぎ
**所要時間**: 2.5時間
**重要度**: 高

- [ ] 作業完了報告書を作成
- [ ] 変更内容の詳細を記録
- [ ] 他メンバーへの引き継ぎ資料を作成
- [ ] 注意事項と制限事項を整理
- [ ] 全体の最終検証結果を報告

---

## 成果物

1. **molecules レベルコンポーネント**
   - `TagInputField.tsx` - タグ入力統合コンポーネント
   - `DateField.tsx` - 日付選択統合コンポーネント

2. **organisms レベルコンポーネント**
   - `PersonForm.tsx` - 人物フォーム（ビジネスロジック分離済み）
   - `EventForm.tsx` - イベントフォーム（ビジネスロジック分離済み）
   - `SwipeableCard.tsx` - 汎用スワイプカード
   - `SwipeableCardList.tsx` - 汎用スワイプカードリスト

3. **統合された画面**
   - `person-register.tsx` - 登録・編集統合画面

4. **整理されたUI要素**
   - スタイルファイル分離
   - TabBarBackground の整理

## 重要な注意事項

1. **既存機能の完全保持**
   - **TagInputWithSuggestions**: 新規作成、選択、削除の全フローを完全に維持
   - **DateTimePicker**: テーマ対応、過去日付制限、日付クリア機能を完全に維持
   - **フォームバリデーション**: Zodスキーマの全ルールを完全に維持
   - **スワイプ削除**: openedMenuIdAtom との連携と同時開放制御を完全に維持

2. **段階的な統合**
   - 既存コンポーネントを残しながら新しいコンポーネントを作成
   - 動作確認後に置き換えを実施
   - 問題があれば即座にロールバック

3. **再利用性とのバランス**
   - 汎用化により既存機能を破壊しない
   - 既存の使用方法との互換性を保つ
   - パフォーマンスを劣化させない

4. **他メンバーとの連携**
   - メンバー1の基盤整備完了を待つ
   - メンバー3のカスタムフック作成と連携
   - 変更内容を随時共有

5. **テストの徹底**
   - 各コンポーネントの個別テスト
   - 統合後の全機能テスト
   - 既存機能との動作比較
   - パフォーマンステスト

6. **品質保証**
   - TypeScript型安全性を維持
   - アクセシビリティを維持
   - テーマ対応を維持
   - レスポンシブ対応を維持